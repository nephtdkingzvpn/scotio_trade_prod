{% extends '../base.html' %}

{% load static %}

{% load humanize %}

{% block content %}
<div class="container">
    <div class="dashboard__header">
        <h4>Welcome: {{request.user.email}}</h4>
        <hr>
    </div>

    <!-- credit cards -->
    <div class="credit_cards">
        <div class="my__card">
            <div class="top">
                <div class="left">
                    <img src="{% static 'account/images/BTC.png' %}" alt="card1-1">
                    <h2>BTC</h2>
                </div>
                <img src="{% static 'account/images/visa.png' %}" class="right"   alt="card1-2">
            </div>
            <div class="middle">
                <h1>$543,106</h1>
                <div class="chip">
                  <img src="{% static 'account/images/card chip.png' %}" class="chip" alt="card-chip">
                </div>
            </div>
            <div class="bottom">
                <div class="left">
                    <small>Card Holder</small>
                    <h5>WILLIAM PI</h5>
                </div>
                <div class="right">
                    <div class="expiry">
                        <small>Expiry</small>
                        <h5>06/24</h5>
                    </div>
                    <div class="cvv">
                        <small>CVV</small>
                        <h5>123</h5>
                    </div>
                </div>
            </div>
        </div>
        <!-- card 2 -->
        <div class="my__card">
            <div class="top">
                <div class="left">
                    <img src="{% static 'account/images/ETH.png' %}" alt="card2-1">
                    <h2>ETH</h2>
                </div>
                <img src="{% static 'account/images/revolute.png' %}" class="right"   alt="card2-2">
            </div>
            <div class="middle">
                <h1>$277,762</h1>
                <div class="chip">
                    <img src="{% static 'account/images/card chip.png' %}" class="chip" alt="card-chip">
                </div>
            </div>
            <div class="bottom">
                <div class="left">
                    <small>Card Holder</small>
                    <h5>WILLIAM PI</h5>
                </div>
                <div class="right">
                    <div class="expiry">
                        <small>Expiry</small>
                        <h5>11/25</h5>
                    </div>
                    <div class="cvv">
                        <small>CVV</small>
                        <h5>789</h5>
                    </div>
                </div>
            </div>
        </div>
        <!-- card 3 -->
        <div class="my__card">
            <div class="top">
                <div class="left">
                    <img src="{% static 'account/images/USDT.png' %}" alt="card3-1">
                    <h2>USDT</h2>
                </div>
                <img src="{% static 'account/images/master card.png' %}" class="right"   alt="card3-2">
            </div>
            <div class="middle">
                <h1>$120,988</h1>
                <div class="chip">
                    <img src="{% static 'account/images/card chip.png' %}" class="chip" alt="card-chip">
                </div>
            </div>
            <div class="bottom">
                <div class="left">
                    <small>Card Holder</small>
                    <h5>WILLIAM PI</h5>
                </div>
                <div class="right">
                    <div class="expiry">
                        <small>Expiry</small>
                        <h5>05/27</h5>
                    </div>
                    <div class="cvv">
                        <small>CVV</small>
                        <h5>456</h5>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- widget marquee -->
    <div class="marquee__wrapper mt-3">
        {% include '../tradingviewchart/tickertape.html' %}
    </div>

    <!-- monthly report -->
    <div class="monthly-report">
        <div class="report">
            <h3>Balance</h3>
            <div>
                <details>
                    <h1>$19,230</h1>
                    <h4 class="text-success">+4.6%</h4>
                </details>
                <p class="text-muted">Compared to $18,384 last month</p>
            </div>
        </div>
        <div class="report">
            <h3>Profit</h3>
            <div>
                <details>
                    <h1>$9,113</h1>
                    <h4 class="text-danger">-6.2%</h4>
                </details>
                <p class="text-muted">Compared to $9,715 last month</p>
            </div>
        </div>
        <div class="report">
            <h3>Cashback</h3>
            <div>
                <details>
                    <h1>$4,390</h1>
                    <h4 class="text-success">+2.9%</h4>
                </details>
                <p class="text-muted">Compared to $4,266 last month</p>
            </div>
        </div>
        <div class="report">
            <h3>Running</h3>
            <div>
                <details>
                    <h1>$86,374</h1>
                    <h4 class="text-danger">-5.2%</h4>
                </details>
                <p class="text-muted">Compared to $91,111 last month</p>
            </div>
        </div>
    </div>
    <div class="card mt-3" style="width: 100%; border-radius: 10px;">
        <canvas id="stock-chart" style="width: 100%; height: 400px;"></canvas>
    </div>
    <!-- <div class="card">
        <canvas id="stock-chart" width="800" height="400"></canvas>
    </div> -->
    
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    // Fetch data from the view
    fetch("{% url 'account:aapl_data_view' %}")
        .then(response => response.json())
        .then(data => {
            var ctx = document.getElementById('stock-chart').getContext('2d');
            var stockChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'AAPL Stock Price',
                        data: data.prices,
                        borderColor: 'blue',
                        fill: false
                    }]
                },
                options: {
                    title: {
                        display: true,
                        text: 'AAPL Stock Price'
                    },
                    scales: {
                        xAxes: [{
                            type: 'time',
                            time: {
                                unit: 'day'
                            },
                            scaleLabel: {
                                display: true,
                                labelString: 'Date'
                            }
                        }],
                        yAxes: [{
                            scaleLabel: {
                                display: true,
                                labelString: 'Price'
                            }
                        }]
                    }
                }
            });
        });
</script>
{% endblock %}